%nav.navbar{id: 'tribe-navigation'}
  .row
    .col-md-2
    .col-md-2
      .refine
    .col-md-6
      %ul.nav.navbar-nav
        %li.custom-center
          %a.tribe-nav-links.active{href: '#'}
            All
        %li.custom-center
          %a.tribe-nav-links{href: '#'}
            Politics
        %li.custom-center
          %a.tribe-nav-links{href: '#'}
            Entertainment
        %li.custom-center
          %a.tribe-nav-links{href: '#'}
            Sports
        %li.custom-center
          %a.tribe-nav-links{href: '#'}
            Business
%nav.navbar{id: 'refine-nav'}
  .row
    .col-md-1
      #brand-refine-bar{style: 'display:none;'}
        Brand
    .col-md-6{id: "duration-header"}
      %ul.nav.nav-tabs  
        %li.refine-link.active
          =link_to 'Hot', root_path
        %li.refine-link{class: ('active' if current_page?('/top/week'))}
          %a.dropdown-toggle{"data-toggle" => "dropdown", href: "#"}
            Top
            %b.caret
          %ul.dropdown-menu
            %li
              =link_to 'Today', top_path('today') 
            %li.divider
            %li
              =link_to 'This week', top_path(duration: 'week')
            %li.divider
            %li
              =link_to 'This month', top_path(duration: 'month') 
            %li.divider
            %li
              =link_to 'This year', top_path(duration: 'year')
            %li.divider
            %li
              =link_to 'All time', top_path(duration: 'all_time')
        %li.refine-link
          =link_to 'New', new_path(duration: 'current')
        %li
          =link_to (fa_icon "plus-circle", class: 'color-light-green', text: 'Submit a new link'), '#', id: 'submit-new-link-refine','data-toggle'=>"modal" ,'data-target'=>"#create-link-modal", style: 'display:none', class: 'btn btn-success'
    .col-md-5
      %ul.nav.navbar-nav.navbar-right{id: 'username-refine', style: 'display:none;'}
        %li{style: 'padding-right: 25px;'}
          -if user_signed_in?
            .btn-group{style: 'cursor:pointer;'}
              #user-name-nav{"data-toggle"=> 'dropdown'}
                =fa_icon "user"
                =current_user.username
                =fa_icon "caret-down"
              %ul.dropdown-menu
                %li
                  =link_to 'My Account', current_user
                %li.divider
                %li
                  =link_to 'Sign out', destroy_user_session_path, method: 'delete'      
          -else
            =link_to('Login', new_user_session_path)
      
    .col-md-4.hidden-div{id: 'user-duration-header'}
      %ul.nav.navbar-nav.navbar-right
        %li
          -if user_signed_in?
            =current_user.email
          -else
            =link_to('Login', new_user_session_path)
        %li
          -if user_signed_in?
            =link_to 'Sign out', destroy_user_session_path, method: 'delete'      
    

:javascript
  $(function(){
    var
      $createLink = $('#submit-new-link-refine'),
      $userLogin = $('#user-duration-header'),
      $brand = $('#brand-refine-bar'),
      $userName = $('#username-refine')
      $win = $(window),

      $filter = $('#refine-nav'),
      $filterSpacer = $('<div />', {
        "class": "filter-drop-spacer",
        "height": $filter.outerHeight()
      });
    $win.scroll(function(){     
      if(!$filter.hasClass('navbar-fixed-top remove-grey-bck-nav') && $win.scrollTop() > $filter.offset().top){
        $filter.before($filterSpacer);
        $filter.addClass("navbar-fixed-top remove-grey-bck-nav");
        $createLink.show();
        $brand.fadeIn();
        $userName.fadeIn();
        $userLogin.show();
      } else if ($filter.hasClass('navbar-fixed-top remove-grey-bck-nav')  && $win.scrollTop() < $filterSpacer.offset().top){
        $filter.removeClass("navbar-fixed-top remove-grey-bck-nav");
        $filterSpacer.remove();
        $createLink.hide();
        $userLogin.hide();
        $brand.fadeOut();
        $userName.fadeOut();

      }
    });
  });